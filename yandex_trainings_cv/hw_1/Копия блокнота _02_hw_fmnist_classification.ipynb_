{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"3isBRG6PgSq6"},"outputs":[],"source":["# do not change the code in the block below\n","# __________start of block__________\n","import json\n","import os\n","import re\n","\n","import numpy as np\n","import torch\n","import torchvision\n","from IPython.display import clear_output\n","from matplotlib import pyplot as plt\n","from torch import nn\n","from torch.nn import functional as F\n","from torchvision.datasets import FashionMNIST\n","\n","# __________end of block__________"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xcwlqT5vjivs"},"outputs":[],"source":["# do not change the code in the block below\n","# __________start of block__________\n","def get_predictions(model, eval_data, step=10):\n","\n","    predicted_labels = []\n","    model.eval()\n","    with torch.no_grad():\n","        for idx in range(0, len(eval_data), step):\n","            y_predicted = model(eval_data[idx : idx + step].to(device))\n","            predicted_labels.append(y_predicted.argmax(dim=1).cpu())\n","\n","    predicted_labels = torch.cat(predicted_labels)\n","    predicted_labels = \",\".join([str(x.item()) for x in list(predicted_labels)])\n","    return predicted_labels\n","\n","\n","def get_accuracy(model, data_loader):\n","    predicted_labels = []\n","    real_labels = []\n","    model.eval()\n","    with torch.no_grad():\n","        for batch in data_loader:\n","            y_predicted = model(batch[0].to(device))\n","            predicted_labels.append(y_predicted.argmax(dim=1).cpu())\n","            real_labels.append(batch[1])\n","\n","    predicted_labels = torch.cat(predicted_labels)\n","    real_labels = torch.cat(real_labels)\n","    accuracy_score = (predicted_labels == real_labels).type(torch.FloatTensor).mean()\n","    return accuracy_score\n","\n","\n","# __________end of block__________"]},{"cell_type":"markdown","metadata":{"id":"pPCD5F-Ujivt"},"source":["Загрузите файл `hw_overfitting_data_dict.npy` (ссылка есть на странице с заданием), он понадобится для генерации посылок. Код ниже может его загрузить (но в случае возникновения ошибки скачайте и загрузите его вручную).\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vCTiCrbfjivv","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295179715,"user_tz":-180,"elapsed":608,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"c8ca6c2a-0d01-48b1-973a-e49abbacf54f"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2025-04-10 14:26:18--  https://github.com/girafe-ai/ml-course/raw/24f_ysda/homeworks/hw_overfitting/hw_overfitting_data_dict\n","Resolving github.com (github.com)... 140.82.116.3\n","Connecting to github.com (github.com)|140.82.116.3|:443... connected.\n","HTTP request sent, awaiting response... 302 Found\n","Location: https://raw.githubusercontent.com/girafe-ai/ml-course/24f_ysda/homeworks/hw_overfitting/hw_overfitting_data_dict [following]\n","--2025-04-10 14:26:19--  https://raw.githubusercontent.com/girafe-ai/ml-course/24f_ysda/homeworks/hw_overfitting/hw_overfitting_data_dict\n","Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...\n","Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 6272446 (6.0M) [application/octet-stream]\n","Saving to: ‘hw_overfitting_data_dict.npy’\n","\n","hw_overfitting_data 100%[===================>]   5.98M  --.-KB/s    in 0.07s   \n","\n","2025-04-10 14:26:19 (82.7 MB/s) - ‘hw_overfitting_data_dict.npy’ saved [6272446/6272446]\n","\n"]}],"source":["!wget https://github.com/girafe-ai/ml-course/raw/24f_ysda/homeworks/hw_overfitting/hw_overfitting_data_dict -O hw_overfitting_data_dict.npy"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"az_hrIG6jivw"},"outputs":[],"source":["# do not change the code in the block below\n","# __________start of block__________\n","assert os.path.exists(\n","    \"hw_overfitting_data_dict.npy\"\n","), \"Please, download `hw_overfitting_data_dict.npy` and place it in the working directory\"\n","\n","# __________end of block__________"]},{"cell_type":"markdown","metadata":{"id":"zeA6Q5-CgSq7"},"source":["Вернемся к задаче распознавания простых изображений, рассмотренной ранее. Но теперь будем работать с набором данных [FashionMNIST](https://github.com/zalandoresearch/fashion-mnist). В данном задании воспользуемся всем датасетом целиком.\n","\n","__Ваша первая задача: реализовать весь пайплан обучения модели и добиться качества $\\geq 88.5\\%$ на тестовой выборке.__\n","\n","Код для обучения модели в данном задании отсутствует. Присутствует лишь несколько тестов, которые помогут вам отладить свое решение. За примером можно обратиться к ноутбукам с предыдущих занятий."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tyLaUu9djivz"},"outputs":[],"source":["CUDA_DEVICE_ID = 0  # change if needed"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nPG1KbQAgl8b"},"outputs":[],"source":["# do not change the code in the block below\n","# __________start of block__________\n","device = (\n","    torch.device(f\"cuda:{CUDA_DEVICE_ID}\") if torch.cuda.is_available() else torch.device(\"cpu\")\n",")\n","# __________end of block__________"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aYcL28OsgSq8","colab":{"base_uri":"https://localhost:8080/","height":470},"executionInfo":{"status":"ok","timestamp":1744295198541,"user_tz":-180,"elapsed":467,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"a4d97783-9146-4eaa-9e6b-f28bfc064146"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Text(0.5, 1.0, 'Image label: 9')"]},"metadata":{},"execution_count":37},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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tmzZopqaGvXv3z/83Np5553XaPtB20MBoc377//+b1199dV67rnnIraXl5crNTU1/HH37t31ySefyBgT8QN9+/btEbmePXtKOvqb/rBhw771/A4ePKgVK1ZoxowZmjZtWnj712daJ7Jt2zbl5OREzDEUCoX/ZNazZ08ZY5STk9MsJeD3+yPK+J133pGkRjk+aLt4Dghtnt/vP+5KsldeeeW4K7xyc3P15Zdf6k9/+lN4W21trX73u99FjBswYIB69uyp//zP/1R1dfVx+ztw4ID1/CQdN8fZs2efNPP1JehfmzNnjiQpPz9fknTTTTfJ7/drxowZx31eY8xJL+/+2plehn0iBw4c0BNPPKF+/fpRQDglzoDQ5l133XV65JFHNG7cOH3/+9/Xli1btHDhQvXo0SNi3M9+9jM9/fTTuvXWW3XPPfcoMzNTCxcuVGxsrKR//pkrKipKv//975Wfn68LLrhA48aNU5cuXfTll1/q3XffVWJiol5//fUznl9iYqIGDx6smTNnqqGhQV26dNGf//zniEvJj1VUVKQbbrhBeXl5Wrt2rV544QWNHj1a/fv3l3T0DOixxx7T1KlTtXPnTo0YMUIJCQkqKirSa6+9pvHjx+vee+896eefOnWq/vjHP6qoqOi0FyJcddVVGjRokM4991wVFxfrt7/9raqrq/XGG2+EL/4AToQCQpv34IMPqqamRosWLdJLL72k733ve/qf//kfPfDAAxHj4uPjtXLlSk2cOFG/+c1vFB8fr9tuu03f//73NXLkyHARSdKQIUO0du1aPfroo3r66adVXV2tjIwMDRw4UD/72c+s57ho0SJNnDhRc+fOlTFGw4cP11tvvaWsrKwTjn/ppZc0bdo0PfDAA2rXrp0mTJigJ598MmLMAw88oPPOO0+//vWvNWPGDElSdna2hg8fHnGl37c1YMCA8BllYmKifvCDH+jRRx89ruCBY/nMsefnACLMnj1bkydP1p49e9SlSxfX0wHaDAoI+IbDhw8f95qc7373uwoGg/rss88czgxoe/gTHPANN910k7p166aLLrpIFRUVeuGFF/Tpp59q4cKFrqcGtDkUEPANubm5+v3vf6+FCxcqGAzqO9/5jhYvXqxbbrnF9dSANoc/wQEAnOAaSQCAExQQAMCJFvccUCgU0t69e5WQkHDc+lYAgJbPGKOqqipl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\n"},"metadata":{}}],"source":["# do not change the code in the block below\n","# __________start of block__________\n","\n","train_fmnist_data = FashionMNIST(\n","    \".\", train=True, transform=torchvision.transforms.ToTensor(), download=True\n",")\n","test_fmnist_data = FashionMNIST(\n","    \".\", train=False, transform=torchvision.transforms.ToTensor(), download=True\n",")\n","\n","\n","train_data_loader = torch.utils.data.DataLoader(\n","    train_fmnist_data, batch_size=32, shuffle=True, num_workers=2\n",")\n","\n","test_data_loader = torch.utils.data.DataLoader(\n","    test_fmnist_data, batch_size=32, shuffle=False, num_workers=2\n",")\n","\n","random_batch = next(iter(train_data_loader))\n","_image, _label = random_batch[0][0], random_batch[1][0]\n","plt.figure()\n","plt.imshow(_image.reshape(28, 28))\n","plt.title(f\"Image label: {_label}\")\n","# __________end of block__________"]},{"cell_type":"code","source":["random_batch = next(iter(train_data_loader))\n","_image, _label = random_batch[0][0], random_batch[1][0]\n","plt.figure()\n","plt.imshow(_image.reshape(28, 28))\n","plt.title(f\"Image label: {_label}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":470},"id":"FniVZwx1nbtu","executionInfo":{"status":"ok","timestamp":1744295201655,"user_tz":-180,"elapsed":369,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"294a6af7-78ec-463b-d165-b1424d4339a7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Text(0.5, 1.0, 'Image label: 1')"]},"metadata":{},"execution_count":38},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAaAAAAGzCAYAAABpdMNsAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAJk9JREFUeJzt3XtwVGWe//FPdy6dQC4YQm4QMEQuM1xXRiOjE1GyJLG8MFCFqLsC48KoCSuwOprZEQQds+IugzoRq3ZcMrOCsG4JrO4MDgZIfo4BBxTBnyMLGASEBJMhCQnkQvr5/cGP3mkShNMkeXJ5v6pOVfr0+fbz7cMJn5zu00+7jDFGAAB0MrftBgAAvRMBBACwggACAFhBAAEArCCAAABWEEAAACsIIACAFQQQAMAKAggAYAUBBHSyw4cPy+VyqbCw0HHtM888I5fLpcrKynbrZ/bs2br22mvb7fGAK0UAoUspLCyUy+XSrl27bLeCK7R+/Xr9zd/8jYYNGyaXy6VJkybZbgndRLDtBgB0b6tWrdLu3bt1ww03qKqqynY76EYIIABX5d///d81cOBAud1ujR492nY76EZ4CQ5d3uzZsxUREaEjR47ozjvvVEREhAYOHKiCggJJ0r59+3T77berb9++GjJkiNauXetX/+c//1mPP/64xowZo4iICEVFRSk7O1uffvppq7G++uor3X333erbt6/i4uK0cOFCvffee3K5XNq+fbvftjt37lRWVpaio6PVp08f3XrrrfrDH/4Q0HPcu3evZs+eraFDhyosLEwJCQn60Y9+dMkzisrKSs2YMUNRUVHq37+/HnvsMTU0NLTa7o033tCECRMUHh6umJgYzZw5U0ePHr1sPydOnNAXX3yh5ubmy26bnJwst5v/SuAcRw26hZaWFmVnZys5OVnLly/Xtddeq9zcXBUWFiorK0vf+9739MILLygyMlIPPvigysrKfLVffvmlNm7cqDvvvFMrVqzQE088oX379unWW2/V8ePHfdvV19fr9ttv1/vvv6+///u/1z/+4z/qww8/1JNPPtmqn61btyo9PV21tbVasmSJnn/+eVVXV+v222/XRx995Pj5bdmyRV9++aXmzJmjV155RTNnztS6det0xx13qK1vTJkxY4YaGhqUn5+vO+64Qy+//LLmzZvnt83Pf/5zPfjggxo2bJhWrFih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srKyNG3aNKWkpOjQoUP66U9/quzsbJWWliooKMh2e+3O6/VqwYIFuvnmmzV69GhJ54+H0NBQ9evXz2/bnnw8tLUfJOn+++/XkCFDlJSUpL179+rJJ5/U/v379fbbb1vs1l+XDyD8r+zsbN/PY8eOVVpamoYMGaL/+I//0EMPPWSxM3QFM2fO9P08ZswYjR07Vqmpqdq+fbsmT55ssbOOkZOTo88++6xXvA/6bS61H+bNm+f7ecyYMUpMTNTkyZN16NAhpaamdnabberyL8HFxsYqKCio1VUsFRUVSkhIsNRV19CvXz8NHz5cBw8etN2KNReOAY6P1oYOHarY2NgeeXzk5ubq3Xff1bZt2/y+PywhIUFNTU2qrq72276nHg+X2g9tSUtLk6QudTx0+QAKDQ3VhAkTVFRU5Fvn9XpVVFSkiRMnWuzMvrq6Oh06dEiJiYm2W7EmJSVFCQkJfsdHbW2tdu7c2euPj2PHjqmqqqpHHR/GGOXm5mrDhg3aunWrUlJS/O6fMGGCQkJC/I6H/fv368iRIz3qeLjcfmjLnj17JKlrHQ+2r4K4EuvWrTMej8cUFhaazz//3MybN8/069fPlJeX226tU/3DP/yD2b59uykrKzN/+MMfTEZGhomNjTUnT5603VqHOn36tPnkk0/MJ598YiSZFStWmE8++cR89dVXxhhj/umf/sn069fPbNq0yezdu9fcc889JiUlxZw9e9Zy5+3r2/bD6dOnzeOPP25KS0tNWVmZef/99831119vhg0bZhoaGmy33m4eeeQREx0dbbZv325OnDjhW86cOePb5uGHHzaDBw82W7duNbt27TITJ040EydOtNh1+7vcfjh48KBZtmyZ2bVrlykrKzObNm0yQ4cONenp6ZY799ctAsgYY1555RUzePBgExoaam688UazY8cO2y11unvvvdckJiaa0NBQM3DgQHPvvfeagwcP2m6rw23bts1IarXMmjXLGHP+Uuynn37axMfHG4/HYyZPnmz2799vt+kO8G374cyZM2bKlClmwIABJiQkxAwZMsTMnTu3x/2R1tbzl2RWr17t2+bs2bPm0UcfNddcc43p06eP+eEPf2hOnDhhr+kOcLn9cOTIEZOenm5iYmKMx+Mx1113nXniiSdMTU2N3cYvwvcBAQCs6PLvAQEAeiYCCABgBQEEALCCAAIAWEEAAQCsIIAAAFYQQAAAKwggAIAVBBAAwAoCCABgBQEEALDi/wH6HtflAMLaegAAAABJRU5ErkJggg==\n"},"metadata":{}}]},{"cell_type":"code","source":["print(random_batch[0].size(), random_batch[1].size())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G5ztFivVnhiC","executionInfo":{"status":"ok","timestamp":1744295206496,"user_tz":-180,"elapsed":36,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"d2a6d7b8-ebea-4e26-a828-7a2506277c03"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([32, 1, 28, 28]) torch.Size([32])\n"]}]},{"cell_type":"markdown","metadata":{"id":"S6jWRv1rgSq8"},"source":["Постройте модель ниже. Пожалуйста, не стройте переусложненную сеть, не стоит делать ее глубже четырех слоев (можно и меньше). Ваша основная задача – обучить модель и получить качество на отложенной (тестовой выборке) не менее 88.5% accuracy.\n","\n","__Внимание, ваша модель должна быть представлена именно переменной `model_task_1`. На вход ей должен приходить тензор размерностью (1, 28, 28).__"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BcyEFX-RgSq8"},"outputs":[],"source":["# Creating model instance\n","model_task_1 = None\n","# your code here"]},{"cell_type":"code","source":["class MLP(nn.Module):\n","  def __init__(self) -> None:\n","      super(MLP, self).__init__()\n","      self.fc1 = nn.Linear(784, 196)\n","      self.fc2 = nn.Linear(196, 100)\n","      self.fc3 = nn.Linear(100, 10)\n","      self.relu = nn.ReLU()\n","\n","  def forward(self, x):\n","      x = x.view(-1, 28*28)\n","      x = self.relu(self.fc1(x))\n","      x = self.relu(self.fc2(x))\n","      x = self.fc3(x)\n","      return x\n","\n","model_task_1 = MLP()"],"metadata":{"id":"qj73dEl1CCbQ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"bAoLV4dkoy5M"},"source":["Не забудьте перенести модель на выбранный `device`!"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Xas9SIXDoxvZ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295214302,"user_tz":-180,"elapsed":30,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"1aeca0f4-9fe9-4dba-a01b-e0d18102c0b1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["MLP(\n","  (fc1): Linear(in_features=784, out_features=196, bias=True)\n","  (fc2): Linear(in_features=196, out_features=100, bias=True)\n","  (fc3): Linear(in_features=100, out_features=10, bias=True)\n","  (relu): ReLU()\n",")"]},"metadata":{},"execution_count":41}],"source":["model_task_1.to(device)"]},{"cell_type":"markdown","metadata":{"id":"6pLRWysggSq9"},"source":["Локальные тесты для проверки вашей модели доступны ниже:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_qMQzo1ggSq9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295216765,"user_tz":-180,"elapsed":25,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"f42046a2-af58-44ae-ad10-c71ec5a461b1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Everything seems fine!\n"]}],"source":["# do not change the code in the block below\n","# __________start of block__________\n","assert model_task_1 is not None, \"Please, use `model_task_1` variable to store your model\"\n","\n","try:\n","    x = random_batch[0].to(device)\n","    y = random_batch[1].to(device)\n","\n","    # compute outputs given inputs, both are variables\n","    y_predicted = model_task_1(x)\n","except Exception as e:\n","    print(\"Something is wrong with the model\")\n","    raise e\n","\n","\n","assert y_predicted.shape[-1] == 10, \"Model should predict 10 logits/probas\"\n","\n","print(\"Everything seems fine!\")\n","# __________end of block__________"]},{"cell_type":"code","source":["import torch.optim as optim"],"metadata":{"id":"inVAy_ssDvBf"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"suRmIPwIgSq9"},"source":["Настройте параметры модели на обучающей выборке. Также рекомендуем поработать с `learning rate`."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YJnU14bdnZa_"},"outputs":[],"source":["loss_cross = nn.CrossEntropyLoss()\n","optimizer = optim.Adam(model_task_1.parameters(), lr = 0.001)"]},{"cell_type":"code","source":["for epoch in range(20):\n","  for i in train_data_loader:\n","    optimizer.zero_grad()\n","\n","    predict = model_task_1(i[0].to(device))\n","\n","    loss = loss_cross(predict, i[1].to(device))\n","\n","    loss.backward()\n","\n","    optimizer.step()\n","  print(f\"epoch: {epoch}, loss: {loss.item():.4f}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dH8vZTZ1D3zj","executionInfo":{"status":"ok","timestamp":1744295738696,"user_tz":-180,"elapsed":204870,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"a1ae58cd-6eaf-4847-86e9-fe8eb244f9ac"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["epoch: 0, loss: 0.3889\n","epoch: 1, loss: 0.2498\n","epoch: 2, loss: 0.3563\n","epoch: 3, loss: 0.3229\n","epoch: 4, loss: 0.3629\n","epoch: 5, loss: 0.1681\n","epoch: 6, loss: 0.4859\n","epoch: 7, loss: 0.2139\n","epoch: 8, loss: 0.3140\n","epoch: 9, loss: 0.3108\n","epoch: 10, loss: 0.2576\n","epoch: 11, loss: 0.1629\n","epoch: 12, loss: 0.0494\n","epoch: 13, loss: 0.2366\n","epoch: 14, loss: 0.0448\n","epoch: 15, loss: 0.1552\n","epoch: 16, loss: 0.1897\n","epoch: 17, loss: 0.2084\n","epoch: 18, loss: 0.0938\n","epoch: 19, loss: 0.1477\n"]}]},{"cell_type":"markdown","metadata":{"id":"2zce7gt1gSq-"},"source":["Также, напоминаем, что в любой момент можно обратиться к замечательной [документации](https://pytorch.org/docs/stable/index.html) и [обучающим примерам](https://pytorch.org/tutorials/).  "]},{"cell_type":"markdown","metadata":{"id":"usswrWYOgSq-"},"source":["Оценим качество классификации:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Xua3TVZHgSq-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295805283,"user_tz":-180,"elapsed":8768,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"a8b74048-dba1-40f4-a3ed-ec9f99c70e0a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Neural network accuracy on train set: 0.94027\n"]}],"source":["train_acc_task_1 = get_accuracy(model_task_1, train_data_loader)\n","print(f\"Neural network accuracy on train set: {train_acc_task_1:3.5}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l9KEKXBxgSq-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295811616,"user_tz":-180,"elapsed":1604,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"a7ae8675-24c3-4c30-acd0-e39d28066abf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Neural network accuracy on test set: 0.889\n"]}],"source":["test_acc_task_1 = get_accuracy(model_task_1, test_data_loader)\n","print(f\"Neural network accuracy on test set: {test_acc_task_1:3.5}\")"]},{"cell_type":"markdown","metadata":{"id":"4oyhmMobgSq_"},"source":["Проверка, что необходимые пороги пройдены:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OAIrURCEgSq_"},"outputs":[],"source":["assert test_acc_task_1 >= 0.885, \"Train accuracy is below 0.885 threshold\"\n","assert (\n","    train_acc_task_1 >= 0.905\n","), \"Train accuracy is below 0.905 while test accuracy is fine. We recommend to check your model and data flow\""]},{"cell_type":"markdown","metadata":{"id":"MrPrg1cSjiwB"},"source":["Обращаем внимане, код ниже предполагает, что ваша модель имеет содержится в переменной `model_task_1`, а файл `hw_fmnist_data_dict.npy` находится в той же директории, что и ноутбук (он доступен в репозитории)."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X87iedgjjiwB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744295999816,"user_tz":-180,"elapsed":40,"user":{"displayName":"Андрей Власов","userId":"01697232066014171870"}},"outputId":"df1b1770-1492-42b2-ae51-dee1472b5dc5"},"outputs":[{"output_type":"stream","name":"stdout","text":["File saved to `submission_dict_fmnist_task_1.json`\n"]}],"source":["# do not change the code in the block below\n","# __________start of block__________\n","assert os.path.exists(\n","    \"hw_fmnist_data_dict.npy\"\n","), \"Please, download `hw_fmnist_data_dict.npy` and place it in the working directory\"\n","\n","loaded_data_dict = np.load(\"hw_fmnist_data_dict.npy\", allow_pickle=True)\n","\n","submission_dict = {\n","    \"train_predictions_task_1\": get_predictions(\n","        model_task_1, torch.FloatTensor(loaded_data_dict.item()[\"train\"])\n","    ),\n","    \"test_predictions_task_1\": get_predictions(\n","        model_task_1, torch.FloatTensor(loaded_data_dict.item()[\"test\"])\n","    ),\n","}\n","\n","with open(\"submission_dict_fmnist_task_1.json\", \"w\") as iofile:\n","    json.dump(submission_dict, iofile)\n","print(\"File saved to `submission_dict_fmnist_task_1.json`\")\n","# __________end of block__________"]},{"cell_type":"markdown","metadata":{"id":"PG7oHGCHjiwB"},"source":["### Сдача задания\n","Сдайте сгенерированный файл в соответствующую задачу в соревновании, а именно:\n","    \n","* `submission_dict_fmnist_task_1.json` в задачу Separation"]},{"cell_type":"markdown","metadata":{"id":"OtWnYAN_gSrA"},"source":["На этом задание завершено. Поздравляем!"]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[{"file_id":"https://github.com/girafe-ai/ml-course/blob/25s_ml_trainings_3/homeworks/hw01_classification/02_hw_fmnist_classification.ipynb","timestamp":1744269366891}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.19"},"toc":{"base_numbering":1,"nav_menu":{},"number_sections":true,"sideBar":true,"skip_h1_title":false,"title_cell":"Table of Contents","title_sidebar":"Contents","toc_cell":false,"toc_position":{},"toc_section_display":true,"toc_window_display":false},"vscode":{"interpreter":{"hash":"21499ab2a6726e29f7050b76af0e9680227e613293d630ba279de7ebdfad9cae"}}},"nbformat":4,"nbformat_minor":0}